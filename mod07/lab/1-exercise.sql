---------------------------------------------------------------------
-- LAB 07
--
-- Exercise 1
---------------------------------------------------------------------

---------------------------------------------------------------------
-- Task 1
-- 
-- Выполните код ниже для создания новой таблицы ExtraCustomers. 
---------------------------------------------------------------------

CREATE TABLE public.extracustomers(
	custid int GENERATED BY DEFAULT AS IDENTITY (START WITH 1 INCREMENT BY 1) NOT NULL,
	fullname varchar(25) NOT NULL,
	city varchar(15) NOT NULL,
	country varchar(15) NOT NULL,
    discount numeric(4,2) NOT NULL,
CONSTRAINT PK_ECustomers PRIMARY KEY(custid)
); 


---------------------------------------------------------------------
-- Task 2
-- 
-- Напишите запрос на вставку одной записи в таблицу ExtraCustomers со следующей информацией:
-- 'Иван Иванов', 'Москва', 'Россия', 0.4

---------------------------------------------------------------------



---------------------------------------------------------------------
-- Task 3
-- 
-- Напишите SELECT-запрос к таблице sales.customers, выводящий всех заказчиков из Германии и Франции.
-- Выведите только полное имя (вычисляемый столбец из companyname и contactname через двоеточие), город, страну. 
--
-- Результирующий набор сравните с Lab Exercise1 - Task3 Result.txt
---------------------------------------------------------------------




---------------------------------------------------------------------
-- Task 4
-- 
-- Используя SELECT-запрос задания 3 вставьте данные в таблицу extracustomers. Скидка у всех заказчиков одинаковая - 40% (0.4).
--
-- Данный запрос должен завершиться ошибкой. Что это за ошибка? Почему так произошло?
-- Какие варианты решения проблемы возможны? Обсудите с коллегами и преподавателем.
---------------------------------------------------------------------




---------------------------------------------------------------------
-- Task 5
-- 
-- Обновите данные в таблице extracustomers, определив скидку 30% для всех заказчиков из Парижа.
--
---------------------------------------------------------------------



---------------------------------------------------------------------
-- Task 6
-- 
-- Удалите заказчика, созданного в Task2.
--
---------------------------------------------------------------------




---------------------------------------------------------------------
-- Task 7
-- 
-- Скопируйте данные о продуктах дороже 50$ из таблицы production.products в несуществующую таблицу public.newproducts.
-- Выполните написанный Вами запрос повторно. Что произошло?
---------------------------------------------------------------------




-- Проверьте данные в таблице public.newproducts
SELECT * FROM public.newproducts;

---------------------------------------------------------------------
-- Task 8 *
-- 
-- Удалите некоторых заказчиков так, чтобы в таблице остались заказчики только по уникальным адресам (city, country).
-- Остаться должны заказчики с наименьшим custid

-- Если Вы все делали верно, то в таблице ExtraCustomers должно остаться 20 строк.
---------------------------------------------------------------------




-- Запросы для проверки

SELECT distinct country, city FROM public.extracustomers;

SELECT * FROM public.extracustomers;


---------------------------------------------------------------------
-- Task 9
-- 
-- Выполните код ниже для удаления таблиц extracustomers, newproducts
---------------------------------------------------------------------

DROP TABLE IF EXISTS public.extracustomers;
DROP TABLE IF EXISTS public.newproducts;
